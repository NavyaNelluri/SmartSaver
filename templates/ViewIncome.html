<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>View Income</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-image: url("{{ url_for('static', filename='homeimg2.png') }}");
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    table {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      border-collapse: collapse;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border: 1px solid #dddddd;
      padding: 12px;
      text-align: left;
      transition: all 0.2s ease-in-out;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    .edit-form {
      display: none;
      background: rgba(255, 255, 255, 0.9);
    }
    .edit-form input, .edit-form select {
      width: calc(100% - 20px);
      padding: 10px;
      margin-bottom: 10px;
      box-sizing: border-box;
    }
    .edit-form button {
      background-color: #4CAF50;
      color: white;
      padding: 10px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }
    .edit-form button:hover {
      background-color: #45a049;
    }
    .edit-button {
      background-color: #FFA500;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }
    .edit-button:hover {
      background-color: #FF8C00;
    }
	   .alert {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            color: white;
            display: inline-block;
            width: 100%;
            box-sizing: border-box;
        }
        .alert-success {
            background-color: #4CAF50; /* Green */
        }
        .alert-error {
            background-color: #f44336; /* Red */
        }
        .alert-warning {
            background-color: #ff9800; /* Orange */
        }
        .alert-info {
            background-color: #2196F3; /* Blue */
        }
  </style>
</head>
<body>
  <h1>View Income</h1>
{% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% set latest_message = messages[-1] %}
                    <div class="alert alert-{{ latest_message[0] }}">
                        {{ latest_message[1] }}
                    </div>
                    <script>
                        setTimeout(function() {
                            document.querySelector('.alert').style.display = 'none';
                        }, 5000);
                    </script>
                {% endif %}
            {% endwith %}
  <table>
    <thead>
      <tr>
        <th>Income Source</th>
        <th>Frequency</th>
        <th>Amount</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for income in incomes %}
      <tr>
        <td>{{ income[0] }}</td>
        <td>{{ income[1] }}</td>
        <td>{{ income[2] }}</td>
        <td>
          <button class="edit-button" onclick="toggleEditForm('{{ income[3] }}')">Edit</button>
        </td>
      </tr>
      <tr class="edit-form" id="editForm{{ income[3] }}">
        <td colspan="4">
          <form method="POST" action="{{ url_for('edit_income', income_id=income[3]) }}">
            <input type="hidden" name="income_id" value="{{ income[3] }}">
            <label for="frequency">Frequency:</label>
            <select name="frequency" id="frequency">
              <option value="weekly" {% if income[1] == 'weekly' %}selected{% endif %}>Weekly</option>
              <option value="bi-weekly" {% if income[1] == 'bi-weekly' %}selected{% endif %}>Bi-Weekly</option>
              <option value="monthly" {% if income[1] == 'monthly' %}selected{% endif %}>Monthly</option>
              <option value="OneTimeIncome" {% if income[1] == 'OneTimeIncome' %}selected{% endif %}>One Time Income</option>
            </select>
            <label for="notes">Source of income:</label>
            <input type="text" id="notes" name="Notes" value="{{ income[0] }}" required>
            <label for="dollars">Amount:</label>
            <input type="number" id="dollars" name="dollars" value="{{ income[2] }}" required>
            <button type="submit">Save</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <script>
    function toggleEditForm(incomeId) {
      var editForm = document.getElementById('editForm' + incomeId);
      if (editForm.style.display === "none" || editForm.style.display === "") {
        editForm.style.display = "table-row";
      } else {
        editForm.style.display = "none";
      }
    }
  </script>
</body>
</html>
